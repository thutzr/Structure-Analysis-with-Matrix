# 结构矩阵分析期末大作业

> 姓名：谭泽人
>
> 班级： 结62
>
> 学号：2016010168
[TOC]

## 源程序清单
### 类
* Joint
* Element
* Internal
* JointLoad
* ElemLoad
* Kcol
### 函数
* SetElemProp
* TransMatrix
* SetMatBand
* SetMatBand2
* varBandSolv
* varBandSolv2
* GStifMat
* DynamicGStifMat
* GLocVec
* EStifMat
* DynamicEStifMat
* DynamicEStifMatDiff
* ElemDisp
* calculate_J_0
* calculate_J_K
* findFreq
* addInternal
* interDisp
* solveDisp
* InputData
* OutputResult

## 代码

### 导入所需要的包

> 在这里我们主要用到了
>
> * `__future__`包用来进行除法，这是因为python中除法会保留整数位不是小数
> * `numpy` 和`scipy`用来进行科学计算
> * `copy`用来进行深度copy

### 类定义

* 节点类

  ```python
  class Joint():
      '''这是节点类'''
      def __init__(self,x,y,GDOF):
          '''
          para::
              x: 节点的x坐标
              y: 节点的y坐标
              GDOF: 节点的整体位移编号，是一个三维向量
          '''
          self.x = x
          self.y = y
          self.gdof = GDOF
  ```
* 单元类
  ```python
class Element():
    '''这是单元类'''
    def __init__(self,JointNo,GlbDOF,Length,CosA,SinA,EI,EA,mass):
        '''
        para::
            JointNo: 两端节点的编号，为二维的向量
            GlbDOF: 单元的整体自由度编号，每个节点有三个编号，故共六个，为六维向量
            Length: 单元的长度
            CosA: 单元与整体x方向夹角的余弦值，在SetElemProp中计算
            SinA: 单元与整体x方向夹角的正弦值，在SetElemProp中计算
            EI: 单元抗弯刚度
            EA: 单元的抗拉刚度
            mass: 单元的质量
        '''
        self.jointNo = JointNo
        self.glbdof = GlbDOF
        self.len = Length
        self.cos = CosA
        self.sin = SinA
        self.ei = EI
        self.ea = EA
        self.m = mass
  ```

* 内部节点类

  ```python
  class Internal():
      '''这是加入的内部节点的类 '''
      def __init__(self, elemNo, pos, u_0, v_0, theta_0, x, y, GDOF):
          self.elemNo = elemNo
          self.pos = pos
          self.u_0 = u_0
          self.v_0 = v_0
          self.theta_0 = theta_0
          self.x = x
          self.y = y
          self.gdof = GDOF
  ```

* 节点荷载类

  ```python
  class JointLoad():
      '''这是节点荷载类'''
      def __init__(self,JointNo,LodDOF,LodVal):
          '''
          para::
              JointNo: 节点编号
              LodDOF: 荷载的方向，即与哪个方向的自由度对应
              LodVal: 荷载的大小
          '''
          self.jointNo = JointNo
          self.lodDof = LodDOF
          self.lodVal = LodVal
  ```

* 单元荷载类

  ```python
  class ElemLoad():
      '''这是单元均布荷载类'''
      def __init__(self,ElemNo,Indx,Pos,LodVal):
          '''
          para::
              ElemNo: 单元编号
              Indx: 荷载的方向
              Pos: 荷载的位置
              LodVal: 荷载的大小
          '''
          self.elemNo = ElemNo
          self.idx = Indx
          self.pos = Pos
          self.loVal = LodVal
  ```

### 函数定义
* 单元的属性设置
  > 包括单元两端节点的编号，单元的整体自由度向量，单元两端两个节点的坐标，单元的长度，单元与$x$方向夹角的正余弦值，以及单元的质量

  ```python
  def SetElemProp(Elem, Joint):
    '''
    para::
        Elem: 包含所有单元的数组
        Joint: 包含所有节点的数组
    return:
        Elem
    '''
    Nelem = len(Elem)
    for i in range(Nelem):
        j1 = Elem[i].jointNo[0]
        j2 = Elem[i].jointNo[1]
        Elem[i].glbdof[:3] = Joint[j1-1].gdof
        Elem[i].glbdof[3:] = Joint[j2-1].gdof
        dx = Joint[j2-1].x - Joint[j1-1].x
        dy = Joint[j2-1].y - Joint[j1-1].y
        Elem[i].len = np.sqrt((dx)**2+(dy)**2)
        Elem[i].cos = dx/Elem[i].len
        Elem[i].sin = dy/Elem[i].len
        Elem[i].mass = 0
    return Elem
  ```

* 坐标转换矩阵计算
  > 通过单元与$x$方向夹角的正余弦得到坐标转换矩阵

  ```python
  def TransMatrix(CosA,SinA):
    '''
    para::
        CosA: 单元与整体坐标系之间的夹角的余弦值
        SinA: 单元与整体坐标系之间的夹角的余弦值
    return:
        ET: 局部坐标系下的单元坐标转换矩阵
    '''
    ET = np.array([[0.0]*6]*6)
    ET[0,:2] = [CosA, -SinA]
    ET[1,:2] = [SinA, CosA]
    if(ET[0,:].shape[0] > 2):
        ET[2,2] = 1
    if (ET[0,:].shape[0] > 3):
        ET[3:6,3:6] = ET[:3,:3]
    return ET
  ```
* 变带宽存储方式
  
  > `scipy`中有稀疏矩阵的多种存储方式，这里采用的是CSC(Compressed Sparse Column)存储方式，对应的就是课上学的变带宽存储方式，一个`numpy array`存储一列种非零元素所在的行号，一个存储每一列中非零元素的数量，还有一个存储所有的非零元素
```python
def SetMatBand(Kcol,Elem):
    '''
    para::
        Kcol: 整体刚度矩阵，与上述定义的Kcol不同
        Elem: 包含所有单元的数组
    '''

    NGlbDOF = len(Kcol[0,:])
    NElem = len(Elem)
    # row1: 每一行的初始行码
    row1 = [NGlbDOF-1]*NGlbDOF
    for i in range(NElem):
        ElocVec = Elem[i].glbdof
        minDOF = 9999999
        for j in range(len(ElocVec)):
            if (ElocVec[j] > 0):
                if (ElocVec[j] < minDOF):
                    minDOF = ElocVec[j]
        for j in range(len(ElocVec)):
            if(ElocVec[j] > 0):
                row1[ElocVec[j]-1] = min([minDOF,row1[ElocVec[j]-1]])
    rowIdx = []
    KVal = []
    indPtr = []
    num = 0
   
    for i in range(NGlbDOF):
        rowIdx.append([x for x in range(row1[i],NGlbDOF-row1[NGlbDOF-1-i])])
        temp = NGlbDOF-row1[NGlbDOF-1-i]-row1[i]+1
        indPtr.append([x for x in range(num,num + temp)])
        num = num + temp
        KVal.append(Kcol[row1[i]:temp+row1[i],i])

#    for i in range(NGlbDOF):
#        Kcol[i].row = [0]*Kcol[0,:].length
    return (rowIdx, KVal, indPtr,row1)
```

* 单元刚度矩阵
  
  > 给定一个单元的抗弯刚度$EI$和抗拉刚度$EA$，计算出单元的刚度矩阵

$$
EK = \begin{bmatrix}
\frac{EA}{l} & 0 & 0 & \frac{EA}{l} & 0 & 0\\
0 & \frac{12EI}{l^3} & \frac{6EI}{l^2} & 0 & -\frac{12EI}{l^3} & \frac{2EI}{l^2} \\
0 & \frac{6EI}{l^2} & \frac{4EI}{l} & 0 & \frac{-6EI}{l^2} & \frac{2EI}{l} \\
\frac{EA}{l} & 0 & 0 & \frac{EA}{l} & 0 & 0\\
0 & -\frac{12EI}{l^3} & -\frac{6EI}{l^2} & 0 \frac{12EI}{l^3} & -\frac{6EI}{l^2}\\
0 & \frac{6EI}{l^2} & \frac{2EI}{l} & 0 & \frac{-6EI}{l^2} & \frac{4EI}{l} \\
\end{bmatrix}
$$

```python
def EStifMat(ELen,EI,EA):
    '''
    para::
        Elem: 包含所有单元的数组
        EI: 单元的抗弯刚度
        EA: 单元的抗拉刚度
    return:
        EK: 单元刚度矩阵
    '''
    EK = np.array([[0.0]*6]*6)
    EAL = EA/ELen
    EIL1 = EI/ELen
    EIL2 = EI/(ELen**2)
    EIL3 = EI/(ELen**3)
    EK[0,:] = [EAL,0,0,-EAL,0,0]
    EK[1,:] = [0,12*EIL3,6*EIL2,0,-12*EIL3,6*EIL2]
    EK[2,:] = [0,6*EIL2,4*EIL1,0,-6*EIL2,2*EIL1]
    EK[3,:] = [-EAL,0,0,EAL,0,0]
    EK[4,:] = [0,-12*EIL3,-6*EIL2,0,12*EIL3,-6*EIL2]
    EK[5,:] = [0,6*EIL2,2*EIL1,0,-6*EIL2,4*EIL1]

    return EK
```

* 单元动力刚度矩阵
  
  > 引入记号
$$
B_1 = \nu \cot nu \quad B_2 = \nu \csc \nu \quad \Phi = 1-\cosh \lambda \cos lambda
$$
$$
T = \frac{\lambda^3}{\Phi}(\sin \lambda \cosh \lambda - \cos \lambda \sinh\lambda \quad R = \frac{\lambda^3}{\Phi}(\sinh \lambda + \sin \lambda)
$$
$$
Q = \frac{\lambda^2}{\Phi}(\sinh\lambda \sin\lambda) \quad H = \frac{\lambda^2}{\Phi}(\cosh \lambda - \cos \lambda)
$$
$$
S = \frac{\lambda}{\Phi}(\sin \lambda \cosh \lambda - \cos \lambda \sinh \lambda)\quad C = \frac{\lambda}{\Phi}(\sinh \lambda - \sin \lambda)
$$
> 得到单元动力刚度矩阵为
$$
\overline{k}^e = \begin{bmatrix}
					B_1\frac{EA}{l} & 0 & 0 & -B_2\frac{EA}{l} & 0 & 0\\
					& T\frac{EI}{l^3} & Q\frac{EI}{l^2} & & -R\frac{EI}{l^3} & H\frac{EI}{l^2}\\
					& & S\frac{EI}{l} & & -H\frac{EI}{l^2} & C\frac{EI}{l}\\
					对 & & & B_1\frac{EA}{l} & & \\
					& & & & T\frac{EI}{l^3} & -Q\frac{EI}{l^2} \\
					& & 称 & & & S\frac{EI}{l}\\
					\end{bmatrix}
$$
```python
def DynamicEStifMat(len, EI, EA, mass, omega):
    '''
    para::
        len:单元的长度
        EI: 单元的抗弯刚度
        EA: 单元的抗拉刚度
        mass: 单元的质量
        omega: 单元的固端振动频率
    '''
    # nu = omega*len*np.sqrt(mass/EA)
    lambda = len*(omega**2*mass/EI)**(1/4)
    B1 = nu/np.tan(nu)
    B2 = nu/np.sin(nu)
    esh = (1-np.exp(-2*lambda))/2
    ech = (1+np.exp(-2*lambda))/2
    phi = np.exp(-lambda) - ech*np.cos(lambda)
    phipie = ech*np.sin(lambda) - esh*np.cos(lambda)
    T = lambda**3/phi*(np.sin(lambda)*ech + np.cos(lambda)*esh)
    R = lambda**3/phi*(esh+np.exp(-lambda)*np.sin(lambda))
    Q = lambda**2/phi*(esh*np.sin(lambda))
    H = lambda**2/phi*(ech-np.exp(-lambda)*np.cos(lambda))
    S = lambda/phi*(np.sin(lambda)*ech-np.cos(lambda)*esh)
    C = lambd/phi*(esh-np.exp(-lambda)*np.sin(lambda))
    S = (1/lambda-phipie/phi)*S+2*Q/lambda
    C = (1/lambda-phipie/phi)*C+H/lambda
    Q = (2/lambda - phipie/phi)*Q+T/lambda
    H = (2/lambda -phipie/phi)*H+R/lambda
    T = (3/lambda - phipie/phi)*T+lambda**3/phi*(2/ech*np.cos(lambda))
    R = (3/lambda - phipie/phi)*R + lambda**3/phi*(ech+np.exp(-lamdba)*np.cos(lambda))
    EK[0,:] = [B1*EA/lem,0,0,-B2*EA/len, 0,0]
    EK[1,:] = [0,T*EI/(len**3),Q*EI/(len**2), 0,-R*EI/(len**3), H*EI/(len**2)]
    EK[2,:] = [0,Q*EI/(len**2),S*EI/len,0,-H*EI/(len**2),C*EI/len]
    EK[3,:] = [-B2*EA/len,0,0,B1*EA/len,0,0]
    EK[4,:] = [0,-R*EI/(len**3),-H*EI/(len**2),0, T*EI/(len**3),-Q*EI/(len**2)]
    EK[5,:] = [0,H*EI/(len**2),C*EI/len,0,-Q*EI/(len**2),S*EI/len]
    return EK
```
* 单元动力矩阵的导数矩阵
$$
\nu_{\omega}^\prime = l \sqrt{\frac{\overline{m}}{EA} \quad \lambda_{\omega}^\prime = \frac{l}{2}\cdot \bigg(\frac{\overline{m}}{\omega^2 EI}\bigg)^{\frac{1}{4}}
}
$$
$$
B_{1\nu}^\prime = \frac{\sin \nu \cos \nu - \nu}{\sin^2\nu} \quad B_{2\nu}^\prime = \frac{\sin \nu - \nu \cos \nu}{\sin^2\nu}
$$
$$
\Phi_{\lambda}^\prime = \cosh \lambda \sin \lambda - \sinh\lambda \cos\lambda
$$
$$
T_{\lambda}^\prime = (\frac{3}{\lambda}- \frac{\Phi_{\lambda}^\prime}{\Phi})T+\frac{\lambda^3}{\Phi}(2\cosh\lambda\cos\lambda)
$$
$$
R_{\lambda}^\prime = (\frac{3}{\lambda}- \frac{\Phi_{\lambda}^\prime}{\Phi})R+\frac{\lambda^3}{\Phi}(\cosh\lambda+\cos\lambda)
$$
$$
Q_{\lambda}^\prime = (\frac{2}{\lambda}- \frac{\Phi_{\lambda}^\prime}{\Phi})Q+\frac{T}{\lambda} \quad H_{\lambda}^\prime = (\frac{2}{\lambda}- \frac{\Phi_{\lambda}^\prime}{\Phi})H+\frac{R}{\lambda}
$$
$$
S_{\lambda}^\prime = (\frac{1}{\lambda}- \frac{\Phi_{\lambda}^\prime}{\Phi})S+\frac{2Q}{\lambda} \quad C_{\lambda}^\prime = (\frac{1}{\lambda}- \frac{\Phi_{\lambda}^\prime}{\Phi})C+\frac{2H}{\lambda}
$$
```python
def DynamicEStifMatDiff(len, EI, EA, mass, omega):
    '''
    para::
        len: 单元的长度
        EI: 单元的抗弯刚度
        EA: 单元的抗拉刚度
        mass: 单元的质量
        omega: 单元的固端频率
    return::
        EK: 单元的动力刚度导数矩阵
    '''
    nu = omega*len*sqrt(mass / EA))
    lambda = len * (omega**2 * mass/EI)**(1/4)
    B1 = (np.sin(nu)*np.cos(nu)- nu)/(np.sin(nu))**2
    B2 = (np.sin(nu) - nu*np.cos(nu))/(np.sin(nu))**2
    esh = (1-np.exp(-2*lambda))/2
    ech = (1+np.exp(-2*lambda))/2
    phi = np.exp(-lambda) - ech*np.cos(lambda)
    phipie = ech*np.sin(lambda) - esh*np.cos(lambda)
    T = lambda**3/phi*(np.sin(lambda)*ech + np.cos(lambda)*esh)
    R = lambda**3/phi*(esh+np.exp(-lambda)*np.sin(lambda))
    Q = lambda**2/phi*(esh*np.sin(lambda))
    H = lambda**2/phi*(ech-np.exp(-lambda)*np.cos(lambda))
    S = lambda/phi*(np.sin(lambda)*ech-np.cos(lambda)*esh)
    C = lambd/phi*(esh-np.exp(-lambda)*np.sin(lambda))
    S = (1/lambda-phipie/phi)*S+2*Q/lambda
    C = (1/lambda-phipie/phi)*C+H/lambda
    Q = (2/lambda - phipie/phi)*Q+T/lambda
    H = (2/lambda -phipie/phi)*H+R/lambda
    T = (3/lambda - phipie/phi)*T+lambda**3/phi*(2/ech*np.cos(lambda))
    R = (3/lambda - phipie/phi)*R + lambda**3/phi*(ech+np.exp(-lamdba)*np.cos(lambda))
    EK[0,:] = [B1*EA/lem,0,0,-B2*EA/len, 0,0]
    EK[1,:] = [0,T*EI/(len**3),Q*EI/(len**2), 0,-R*EI/(len**3), H*EI/(len**2)]
    EK[2,:] = [0,Q*EI/(len**2),S*EI/len,0,-H*EI/(len**2),C*EI/len]
    EK[3,:] = [-B2*EA/len,0,0,B1*EA/len,0,0]
    EK[4,:] = [0,-R*EI/(len**3),-H*EI/(len**2),0, T*EI/(len**3),-Q*EI/(len**2)]
    EK[5,:] = [0,H*EI/(len**2),C*EI/len,0,-Q*EI/(len**2),S*EI/len]
    return EK
```

* 整体刚度矩阵
  
  > 对每个单元先分别计算单元刚度矩阵，再通过单元定为向量和单元的坐标转换矩阵集成为整体刚度矩阵

```python
def GStifMat(Kcol, Elem):
    '''
    para::
        Kcol: 整体刚度矩阵
        Elem: 包含所有单元的数组
    return:
        Kcol: 整体刚度矩阵
    '''
    NElem = len(Elem)
    for i in range(NElem):
        # 计算局部坐标系下的单元刚度矩阵
        EK = EStifMat(Elem[i].len,Elem[i].ei,Elem[i].ea)
        # 计算单元坐标转换矩阵
        ET = TransMatrix(Elem[i].cos,Elem[i].sin)
        # 整体坐标系下的单元刚度矩阵
        EK = np.matmul(np.transpose(ET),np.matmul(EK,ET))
        # 单元定位向量
        ELocVec = Elem[i].glbdof
        for j in range(6):
            JGDOF = ELocVec[j]
            if(JGDOF == 0):
                continue
            # 当节点的位移编码不为0时
            for k in range(len(ELocVec)):
                # 将单元刚度矩阵集成到整体刚度矩阵上
                if((ELocVec[k] > 0) and (ELocVec[k] <= JGDOF)):
                    Kcol[ELocVec[k]-1,JGDOF-1] += EK[k,j]

    return Kcol
```

* 整体动力刚度矩阵
```python
def DynamicGStifMat(Kcol, omega, Elem, add, NGlbDOF):
    '''
    para::
        Kcol: 整体刚度矩阵
        omega: 单元频率
        Elem: 单元数组
        add:
        NGlbDOF: 整体自由度数
    '''
    NElem = len(Elem)
    M = np.zeros((6,6))
    count = 1
    for ie in range(NElem):
        if (add[ie] == 0):
            # 计算局部坐标系下的单元刚度矩阵
            EK = DynamicEStifMat(Elem[i].len, Elem[i].ei, Elem[i].ea, Elem[i].m, omega)
            # 计算单元坐标转换矩阵
            ET = TransMatrix(Elem[i].cos, Elem[i].sin)
            # 整体坐标系下的单元刚度矩阵
            EK = np.matmul(np.transpose(ET), np.matmul(EK ,ET))
            # 单元定位向量
            ELocVec = Elem[i].glbdof
            for j in range(6):
                JGDOF = ELocVec[j]
                if(JGDOF == 0):
                    continue
                # 当节点的位移编码不为0时
                for k in range(len(ELocVec)):
                    # 将单元刚度矩阵集成到整体刚度矩阵上
                    if((ELocVec[k] > 0) and (ELocVec[k] <= JGDOF)):
                        Kcol[ELocVec[k]-1,JGDOF-1] += EK[k,j]
            EK = DynamicEStifMatDiff(Elem[ie].len, Elem[ie].ei, Elem[ie].ea, Elem[ie].m, omega)
            for i in range(6):
                JGDOF = ElocVec[i]
                if(JGDOF==0):
                    continue
                for j in range(len(ELocVec)):
                    if (ELocVec <= JGDOF) and (ELocVec > 0):
                        M[ELocVec[j], JGDOF] += EK[:,i]

        else:
            ET = TransMatrix(Elem[ie].cos,Elem[ie].sin)
            # 计算局部坐标系下的单元刚度矩阵
            EK = DynamicEStifMat(Elem[i].len,Elem[i].ei,Elem[i].ea, Elem[i].m, omega)
            EK = np.matmul(np.transpose(ET), np.matmul((ET,EK)))
            ELocVec[:3] = Elem[ie].glbdof[:3]
            ELocVec[3:] = [NGlbDOF+3*count-2, NGlbDOF+3*count-1,NGlbDOF+3*count]
            for i in range(6):
                JGDOF = ElocVec[i]
                if(JGDOF==0):
                    continue
                for j in range(len(ELocVec)):
                    if (ELocVec <= JGDOF) and (ELocVec > 0):
                        Kcol[:, JGDOF-1] += EK[:,i]
            EK = DynamicEStifMatDiff(Elem[ie].len, Elem[ie].ei, Elem[ie].ea, Elem[ie].m, omega)
            # 整体坐标系下的单元刚度矩阵
            EK = np.matmul(np.transpose(ET),np.matmul(EK,ET))
            # 单元定位向量
            for i in range(6):
                JGDOF = ELocVec[i]
                if(JGDOF == 0):
                    continue
                # 当节点的位移编码不为0时
                for k in range(len(ELocVec)):
                    # 将单元刚度矩阵集成到整体刚度矩阵上
                    if((ELocVec[k] > 0) and (ELocVec[k] <= JGDOF)):
                        M[ELocVec[k]-1,JGDOF-1] += EK[k,j]
            EK = DynamicEStifMat(Elem[ie].len*(1-add[ie],Elem[ie].ei,Elem[ie].ea, Elem[ie].m, omega))
            EK = np.matmul(np.transpose(ET), np.matmul(EK, ET))
            ELocVec[:3] = [NGlbDOF+3*count-2, NGlbDOF+3*count-1, NGlbDOF+3*count]
            ELocVec[3:] = Elem[ie].glbdof
            for i in range(6):
                JGDOF = ELocVec[i]
                if(JGDOF==0):
                    for j in range(len(ELocVec)):
                        if ((ELocVec[j]>0) and (ELocVec[j]<=JGDOF)):
                            Kcol[ELocVec[j],JGDOF] += EK[:,i]
            EK = DynamicEStifMatDiff(len*(1-add[ie]), Elem[ie].ei, Elem[ie].ea, Elem[ie].m, omega)
            EK = np.matmul(np.transpose(ET), np.matmul(EK, ET))
            for i in range(6):
                JGDOF = ElocVec[i]
                if(JGDOF==0):
                    continue
                for j in range(len(ELocVec)):
                    if ((ELocVec[j]>0) and (ELocVec[j]<=JGDOF)):
                            M[ELocVec[j],JGDOF] += EK[:,i]
            count += 1

    return Kcol
```

* 单元位移计算
  
  > 在计算得到整体位移向量的基础上，我们只需根据单元定位向量就可以得到单元的位移向量

```python
def ElemDisp(Disp,Elem):
    '''
    para::
        Disp: 整体位移向量
        Elem: 一个单元类
    return:
        EDisp: 单元位移向量
    '''
    ET = TransMatrix(Elem.cos,Elem.sin)
    EDisp = np.zeros((6))
    EDisp = np.matmul(EDisp,np.transpose(ET))
    for i in range(len(Elem.glbdof)):
        if(Elem.glbdof[i] > 0):
            EDisp[i] += Disp[Elem.glbdof[i]-1]
    return EDisp
```

* $J_0$的计算
  
  > $J_0$为所有低于$\omega^*$的单元固端频率数，其计算公式为
$$
J_0 = \sum_e (J_a+J_b)
$$
   > 其中$J_a$为轴向振动频率数，其计算公式为
$$
J_a = Int\bigg[\frac{\nu^*}{\pi}\bigg]\quad \nu = \omega \cdot l \sqrt{\frac{\overline{m}}{EA}}
$$
   > $J_b$为弯曲振动的频率数，其计算公式为
$$
J_b = 1 - \frac{1}{2}\cdot\big( 1-(-1)^i sign(1-ch\lambda \cos \lambda)\big) \quad i = Int\bigg[\frac{\lambda}{\pi}\bigg]  \quad \lambda = l\cdot\bigg(\frac{\omega^2 \overline{m}}{EI}\bigg)^{\frac{1}{4}}
$$
```python
def calculate_J0(freq,Elem):
    '''
    para::
        freq: 单元的频率
    '''
    # Ja为轴向振动的频率数
    Ja = 0
    # Jb为弯曲振动的频率数
    Jb = 0
    for ie in range(len(Elem)):
        nu = freq*Elem[ie].len*np.sqrt(Elem[ie].mass/Elem[ie].ea)
        Ja += nu//pi
        lambda = Elem[ie].len*(freq**2*Elem[ie].mass/Elem[ie].ei)**(1/4)
        sg = (-1)**(1-np.cosh(lambda)*np.cos(lambda))
        i = lambda//pi
        Jb += i-(1-(-1)**i*sg)/2
    J0 = Ja + Jb
    return J0
```
* $J_K$的计算
  
  > $J_K$为上三角阵$K^{\Delta}$中对角线上负元素的个数

```python
def calculate_JK(freq,Kcol, Elem):
    '''
    para::
        freq:单元的频率
    '''
    (rowIdx, KVal, indPtr,row1) = SetMatBand(Kcol, Elem)
    Kcol = DynamicGStifMat(Kcol, Elem, freq)
    diag = np.zeros((len(Kcol)))
    (Kcol, diag) = VarBandSolv2(diag,Kcol)
    JK = sum(np.where(diag<0,1,0))
    return JK
```

* 计算频率
  
  > 若设需要求解的第$k$阶频率为$\omega_k$，只需要调整
$$
\left\{
\begin{array}{l}
\omega_u\\
\omega_l\\
\end{array}\right.
  \Rightarrow \left\{\begin{array}{l}
								J|_{\omega_u}\geq k \\
								J|_{\omega_l} \leq k-1\\
								\end{array}\right.
$$
   > 采用二分法，直到
$$
\omega_u - \omega_l \leq Tol\cdot (1+\omega_u)
$$
```python
def findFreq(k,NGlbDOF,Elem,Toler):
    '''
    para::
        k: 需要求解的阶数（基数）
        NGlbDOF: 整体自由度数
        Elem: 单元数组
        Toler: 误差限
    return::
        freq_1: 第k阶频率的下界
        freq_2: 第k阶频率的上界
        n_1: 小于低于freq_1的频率的个数
        n_2: 小于低于freq_2的频率的个数
    '''
    freq_1 = 1
    freq_2 = 10
    GKcol = np.zeros((NGlbDOF))
    # 求解频率的一个下界
    while(True):
        J0_1 = calculate_J0(freq_2, Elem)
        JK = calculate_JK(freq_2,GKcol,Elem)
        J_1 = J0_1 + JK
        if(J_1 < k):
            break;
        freq_1 /= 2
    if(freq_1 < 1):
        freq_2 = freq_1*2
    else:
        # 求解频率的一个上界
        while(True):
            J0_2 = calculate_J0(freq_2,Elem)
            JK = calculate_JK(freq_2,GKcol,Elem)
            J_u = J02 + JK
            if(J_u >= k):
                break
            freq_2 *= 2
    while(True):
        # 通过二分法。根据误差限求解频率
        freq_m = (freq_1+ freq_2)/2
        J0 = calculate_J0(freq_m,Elem)
        JK = calculate_JK(freq_m,GKcol,Elem)
        J_m = J0+JK
        if(J_m >= k):
            freq_2 = freq_m
            J_u = J_m
            J0_2 = J0
        else:
            freq_1 = freq_m
            J_1 = J_m
            J01 = J0
        if((freq_2 - freq_1)<=Toler*(1+freq_2)):
            break
    # 分别计算小于freq_1和freq_2的频率的数量
    J0_1 = calculate_J0(freq_1,Elem)
    J0_2 = calculate_J0(freq_2, Elem)
    JK_1 = calculate_JK(freq_1,GKcol,Elem)
    JK_2 = calculate_JK(freq_2,GKcol,Elem)
    n_1 = J0_1 + JK_1
    n_2 = J0_2 + JK_2
    return (freq_1, freq_2, n_1, n_2)
```

* 求解位移和频率
```python
def solveDisp(Disp,Elem,freq,freq_1,freq_u,Tol,NGlbDOF):
    '''
    para::
        Disp: 整体位移向量
        Elem: 包含所有单元的数组
        Joint: 包含所有节点的数组
        JLoad: 节点荷载向量
        ELoad: 单元荷载向量
    return:
        Kcol: 整体刚度矩阵
        Disp: 整体位移向量
    '''
    Kcol = np.zeros((len(Disp)))
    Kcol_1 = np.zeros((len(Disp)))
    repeat = len(Disp)
    freq_a = (freq_1 + freq_u)/2
    M = np.zeros((len(Disp),len(Disp)))
    Kcol = SetMatBand2(Elem,Kcol, add, NGlbDOF)
    Kcol_1 = copy.copy(Kcol)
    Disp_0 = np.zeros(((len(Disp)))
    for i in range(repeat):
        Disp_0 = np.random.random(len(Disp_0))
        for j in range(i-1):
            alpha = np.dot(Disp[j-1,:],np.matmul(M,Disp_0))/np.dot(Disp[j-1,:],np.matmul(M,Disp[j-1,:]))
            Disp_0 -= alpha*Disp[j-1,:]
        Disp_1 = Disp_0
        Disp_0 -= 1
        while(np.abs(max([np.abs(Disp_0[i] - Disp_1[i]) for i in range(len(len(Disp_0)))]))>Tol):
            Disp_0 = Disp_1
            (Kcol, Disp) = varBandSolv(Kcol,np.matmul(M,Disp_0))
            lambda = 1/Disp_1[np.abs(Disp_1).argmax()]
            Disp_1 = lambda*Disp_1
            Kcol_1 = copy.copy(Kcol)
        Disp[0,:] = Disp_1
    freq = freq_a - lambda
    return (Disp, freq)
```

## 文件I/O
### 文件输入
> 输入文件为SM90.ipt，其格式为

```fortran
2                                      
NFreq,FreqStart,Tol
NElem,NJoint,NGlbDOF,0,0         
Joint%X,Joint%Y, GDOF(1:3)
JointNo1,JointNo2, EA,El,m
```
读取的代码为
```python
def InputData():
	'''
	return::
		NFreq: 求解的频率数
		FreqStart: 求解的起始阶
		Tol: 误差限
		NElem: 单元的数量
		NJoint: 节点的数量
        NGlbDOF: 整体的自由度数
        jointList: 节点的列表
        Elem: 单元的数组
	'''
    with open('SM90.IPT','r') as f:
        PropType = f.readline().strip('\n')
        if(int(PropType) != 2):
            return
        [NFreq, FreqStart, Tol] = f.readline().strip('\n').split(',')
        [NElem,NJoint,NGlbDOF,NJLoad,NELoad] = f.readline().strip('\n').split(',')
        NElem = int(float(NElem))
        NJoint = int(float(NJoint))
        NGlbDOF = int(NGlbDOF)
        NJLoad = int(NJLoad)
        NELoad = int(NELoad)
        jointList = []
        Elem = []
        JLoad = []
        ELoad = []

        for i in range(NJoint):
            temp = f.readline().strip('\n').split(',')
            x = float(temp[0])
            y = float(temp[1])
            gdof = [int(s) for s in temp[2:]]
            joint = Joint(x,y,gdof)
            jointList.append(joint)
    
        for i in range(NElem):
            [jointN1,jointN2,EA,EI,mass] = f.readline().strip('\n').split(',')
            EA = int(float(EA.replace('d','e')))
            # 全部初始化为0
            elem = Element([int(float(jointN1)),int(float(jointN2))],[],0,0,0,int(float(EI)),EA,mass)
            Elem.append(elem)
    return (NFreq, FreqStart, Tol, NElem, NJoint, NGlbDOF, jointList, Elem)
```

### 文件输出
> 输出格式为

​			10 0
​			NFreq
​			Freq(i),0	
​			$u_1,\quad v_1 \quad \theta_1 \quad u_2 \quad v_2 \quad \theta_2$
   代码为

```python
  def OutputResult(NElem,NFreq,FreqStart,Elem,Disp):
  	'''
  	para::
  		NElem: 单元的数量
  		NFreq: 求解的频率的阶数
  		FreqStart: 求解的初始频率
  		Elem: 单元的数组
  		Disp: 整体位移向量
  	'''
    with open('SMCAI90.out','w') as f:
        f.write('10 0\n')
        f.write(NFreq)
        i = FreqStart
        while(i<=FreqStart+NFreq-1):
            (freq_1, freq_2, n_1, n_2)=findFreq(i,NGlbDOF,Elem,Tol)
            NE0 = 0
            repeat = min([n_2,FreqStart+NFreq-1])-max(n_1+1,FreqStart)+1
            add = []
            for ie in range(NElem):
                add.append(addInternal(Elem[ie],freq_1,freq_u))
                if(add[ie] > 0):
                    NE0 += 1
            for ie in range(NElem):
                if(add[ie] > 0):
                    inter[ie].elemNo = ie
                    inter[ie].intType = inttype[ie]
                    inter[ie].pos = add[ie]
                    inter[ie].u_0 = 0
                    inter[ie].v_0 = 0
                    inter[theta_0] = 0
            (Disp,freq) = solveDisp(Disp,freq,Elem,add,freq_1,freq_u,Tol,NGlbDOF)
            for j in range(repeat):
                f.write(str(freq)+str(NE0))
                count = 1
                for ie in range(NElem):
                    if(add[ie]>0):
                        f.write(str(inter[ie].elemNo)+' '+str(inter[ie].pos))
                    IDisp = interDisp(Disp[j,:],NGlbDOF+3*count-2)
                    f.write(IDisp)
                    count += 1
                for ie in range(NElem):
                    ElemDisp(Disp[j,:],Elem[ie])
            i = n_2 + 1
```

### 主程序
```python
if __name__ = '__main__':
    (NFreq, FreqStart, Tol, NElem, NJoint, NGlbDOF, jointList, Elem) = InputData()
    Elem = SetElemProp(Elem, jointList)
    Disp = [0.0]*NGlbDOF
    OutputResult(NElem,Disp,Elem,ELoad)
```

## 输入文件
```latex
    2
          10           1  5.000000000000000E-005
          16          17          35           2           9
  -5  0.000000000000000E+000           0           0
           1
  -5  5.00000000000000                2           3
           4
   0.00000000000000       0.000000000000000E+000           0           0
           0
   0.00000000000000        4.00000000000000                8           9
          10
   0.00000000000000        8.00000000000000                5           6
           7
   0.00000000000000        8.00000000000000                5           6
          11
   0.00000000000000        12.0000000000000               12          13
          14
   0.00000000000000        16.0000000000000               15          16
          17
   0.00000000000000        16.0000000000000               15          16
          27
   6.0000000000000       0.000000000000000E+000           0           0
          31
   6.0000000000000        4.00000000000000               18          19
          20
   6.0000000000000        4.00000000000000               18          19
          32
   6.0000000000000        8.00000000000000               21          22
          23
   6.0000000000000        12.0000000000000               24          25
          26
   6.0000000000000        16.0000000000000               28          29
          30
   11.0000000000000       0.000000000000000E+000           0           0
           0
   11.0000000000000        3.00000000000000               33          34
          35
           1           2   100000.000000000        150000.000000000     
   1.00000000000000     
           2           5   1000000.00000000        10000.0000000000     
   1.00000000000000
           3           4   100000.000000000        15000.000000000     
   1.00000000000000     
           4           6   100000.000000000        15000.000000000     
   1.00000000000000     
           6           7   100000.000000000        15000.000000000     
   1.00000000000000     
           7           8   100000.000000000        15000.000000000     
   1.00000000000000     
           4          11   1000000.00000000        10000.0000000000     
   1.00000000000000     
           6          13   1000000.00000000        10000.0000000000     
   1.00000000000000     
           7          14   1000000.00000000        10000.0000000000     
   1.00000000000000     
           9          15   1000000.00000000        10000.0000000000     
   1.00000000000000     
          10          11   100000.000000000        15000.000000000     
   1.00000000000000     
          11          13   100000.000000000        15000.000000000     
   1.00000000000000     
          13          14   100000.000000000        15000.000000000     
   1.00000000000000     
          14          15   100000.000000000        15000.000000000     
   1.00000000000000     
          12          17   1000000.00000000        10000.0000000000     
   1.00000000000000     
          16          17   100000.000000000        15000.000000000     
   1.00000000000000     
```
## 第一题
### 输入文件
```latex
           2
          10           1  5.000000000000000E-005
          16          17          35           2           9
  -5  0.000000000000000E+000           0           0
           1
  -5  5.00000000000000                2           3
           4
   0.00000000000000       0.000000000000000E+000           0           0
           0
   0.00000000000000        4.00000000000000                8           9
          10
   0.00000000000000        8.00000000000000                5           6
           7
   0.00000000000000        8.00000000000000                5           6
          11
   0.00000000000000        12.0000000000000               12          13
          14
   0.00000000000000        16.0000000000000               15          16
          17
   0.00000000000000        16.0000000000000               15          16
          27
   6.0000000000000       0.000000000000000E+000           0           0
          31
   6.0000000000000        4.00000000000000               18          19
          20
   6.0000000000000        4.00000000000000               18          19
          32
   6.0000000000000        8.00000000000000               21          22
          23
   6.0000000000000        12.0000000000000               24          25
          26
   6.0000000000000        16.0000000000000               28          29
          30
   11.0000000000000       0.000000000000000E+000           0           0
           0
   11.0000000000000        3.00000000000000               33          34
          35
           1           2   100000.000000000        150000.000000000     
   1.00000000000000     
           2           5   1000000.00000000        10000.0000000000     
   1.00000000000000
           3           4   100000.000000000        15000.000000000     
   1.00000000000000     
           4           6   100000.000000000        15000.000000000     
   1.00000000000000     
           6           7   100000.000000000        15000.000000000     
   1.00000000000000     
           7           8   100000.000000000        15000.000000000     
   1.00000000000000     
           4          11   1000000.00000000        10000.0000000000     
   1.00000000000000     
           6          13   1000000.00000000        10000.0000000000     
   1.00000000000000     
           7          14   1000000.00000000        10000.0000000000     
   1.00000000000000     
           9          15   1000000.00000000        10000.0000000000     
   1.00000000000000     
          10          11   100000.000000000        15000.000000000     
   1.00000000000000     
          11          13   100000.000000000        15000.000000000     
   1.00000000000000     
          13          14   100000.000000000        15000.000000000     
   1.00000000000000     
          14          15   100000.000000000        15000.000000000     
   1.00000000000000     
          12          17   1000000.00000000        10000.0000000000     
   1.00000000000000     
          16          17   100000.000000000        15000.000000000     
   1.00000000000000     

```
### 输出文件
```latex
   10           0
          10
    3.92462848666103                0
   0.000000000000000        0.000000000000000       -0.860778742199541D-001
   0.418442027846052        0.555446002177452D-002  -0.790008010655604D-001
   0.418442027846052        0.555446002177452D-002  -0.790008010655604D-001
   0.405841580918908        0.277111696161786D-001   0.477522480034346D-001
   0.000000000000000        0.000000000000000        0.000000000000000     
   0.122149820392619        0.164226750316899D-001  -0.466150197040857D-001
   0.122149820392619        0.164226750316899D-001  -0.466150197040857D-001
   0.405841580918908        0.277111696161786D-001  -0.660573588701959D-001
   0.405841580918908        0.277111696161786D-001  -0.660573588701959D-001
   0.715925503042063        0.359790833768849D-001  -0.600177960758039D-001
   0.715925503042063        0.359790833768849D-001  -0.600177960758039D-001
    1.00000000000000        0.375952408885412D-001  -0.753127891223208D-001
   0.122149820392619        0.164226750316899D-001  -0.466150197040857D-001
   0.121569595604224       -0.158748324871081D-001  -0.407559084016337D-001
   0.405841580918908        0.277111696161786D-001  -0.660573588701959D-001
   0.405773949665541       -0.316420198181690D-001  -0.666987649190137D-001
   0.715925503042063        0.359790833768849D-001  -0.600177960758039D-001
   0.716215182175237       -0.398047527985634D-001  -0.636636680278713D-001
    1.00000000000000        0.375952408885412D-001   0.977855820454418D-002
   0.999780823741100       -0.413059758760550D-001  -0.583815326710350D-001
   0.000000000000000        0.000000000000000       -0.252691843625212D-001
   0.121569595604224       -0.158748324871081D-001  -0.407559084016337D-001
   0.121569595604224       -0.158748324871081D-001  -0.407559084016337D-001
   0.405773949665541       -0.316420198181690D-001  -0.666987649190137D-001
   0.405773949665541       -0.316420198181690D-001  -0.666987649190137D-001
   0.716215182175237       -0.398047527985634D-001  -0.636636680278713D-001
   0.716215182175237       -0.398047527985634D-001  -0.636636680278713D-001
   0.999780823741100       -0.413059758760550D-001  -0.583815326710350D-001
   0.121569595604224       -0.158748324871081D-001   0.271080052759122D-001
   0.122136279523033       -0.372997620845260D-002  -0.467265534170718D-001
   0.000000000000000        0.000000000000000        0.000000000000000     
   0.122136279523033       -0.372997620845260D-002  -0.467265534170718D-001
    10.6075593681844                0
   0.000000000000000        0.000000000000000        0.142237136160951     
  -0.694002265638662        0.730630252694176D-002   0.133030123677473     
  -0.694002265638662        0.730630252694176D-002   0.133030123677473     
  -0.719471566875089        0.533196232501499D-001  -0.774822882749175D-001
   0.000000000000000        0.000000000000000        0.000000000000000     
  -0.438148337012530        0.203225407432938D-001   0.109837400199345     
  -0.438148337012530        0.203225407432938D-001   0.109837400199345     
  -0.719471566875089        0.533196232501499D-001  -0.347990809699679D-001
  -0.719471566875089        0.533196232501499D-001  -0.347990809699679D-001
  -0.141174227775286        0.865291662135902D-001  -0.181372040265637     
  -0.141174227775286        0.865291662135902D-001  -0.181372040265637     
    1.00000000000000        0.967219335310377D-001  -0.332376670067789     
  -0.438148337012530        0.203225407432938D-001   0.109837400199345     
  -0.437589604046524       -0.345366217475065D-001   0.775488652953559D-001
  -0.719471566875089        0.533196232501499D-001  -0.347990809699679D-001
  -0.717614209398797       -0.658637244828360D-001  -0.226626046088398D-001
  -0.141174227775286        0.865291662135902D-001  -0.181372040265637     
  -0.140058456270225       -0.943673260373205D-001  -0.201606789921815     
    1.00000000000000        0.967219335310377D-001   0.891745706660892D-001
   0.999064869336839       -0.998852381259092D-001  -0.254221008111911     
   0.000000000000000        0.000000000000000        0.127271381610015     
  -0.437589604046524       -0.345366217475065D-001   0.775488652953559D-001
  -0.437589604046524       -0.345366217475065D-001   0.775488652953559D-001
  -0.717614209398797       -0.658637244828360D-001  -0.226626046088398D-001
  -0.717614209398797       -0.658637244828360D-001  -0.226626046088398D-001
  -0.140058456270225       -0.943673260373205D-001  -0.201606789921815     
  -0.140058456270225       -0.943673260373205D-001  -0.201606789921815     
   0.999064869336839       -0.998852381259092D-001  -0.254221008111911     
  -0.437589604046524       -0.345366217475065D-001  -0.773819528518225D-001
  -0.423383187543152        0.996541338729715D-002   0.168141736382846     
   0.000000000000000        0.000000000000000        0.000000000000000     
  -0.423383187543152        0.996541338729715D-002   0.168141736382846     
    19.9249154818801                0
   0.000000000000000        0.000000000000000       -0.696456467366999D-001
   0.315140777407778        0.154129721535928D-002  -0.516568523348425D-001
   0.315140777407778        0.154129721535928D-002  -0.516568523348425D-001
  -0.392148062863554D-002   0.529389144389520        0.169848182174002     
   0.000000000000000        0.000000000000000        0.000000000000000     
   0.779402023702335        0.282456605035923       -0.465615594982594D-001
   0.779402023702335        0.282456605035923       -0.465615594982594D-001
  -0.392148062863554D-002   0.529389144389520        0.281246511321106     
  -0.392148062863554D-002   0.529389144389520        0.281246511321106     
  -0.834885344524103        0.724942693913017       -0.785042648457962D-002
  -0.834885344524103        0.724942693913017       -0.785042648457962D-002
   0.705637297889979        0.825973796461336       -0.578424136941524     
   0.779402023702335        0.282456605035923       -0.465615594982594D-001
   0.784805350484446        0.372758631254185        0.176601112462169D-001
  -0.392148062863554D-002   0.529389144389520        0.281246511321106     
  -0.760313752998574D-002   0.682160183960902        0.229857447282724     
  -0.834885344524103        0.724942693913017       -0.785042648457962D-002
  -0.833814401825436        0.887309323009084       -0.667594859155314D-001
   0.705637297889979        0.825973796461336        0.648198024511170     
   0.706479601136734         1.00000000000000       -0.566311325678169     
   0.000000000000000        0.000000000000000       -0.319007318209355     
   0.784805350484446        0.372758631254185        0.176601112462169D-001
   0.784805350484446        0.372758631254185        0.176601112462169D-001
  -0.760313752998574D-002   0.682160183960902        0.229857447282724     
  -0.760313752998574D-002   0.682160183960902        0.229857447282724     
  -0.833814401825436        0.887309323009084       -0.667594859155314D-001
  -0.833814401825436        0.887309323009084       -0.667594859155314D-001
   0.706479601136734         1.00000000000000       -0.566311325678169     
   0.784805350484446        0.372758631254185        0.113174175813292     
   0.707835356684927        0.275066496287976D-002  -0.314634916522220     
   0.000000000000000        0.000000000000000        0.000000000000000     
   0.707835356684927        0.275066496287976D-002  -0.314634916522220     
    21.8309238222386                0
   0.000000000000000        0.000000000000000        0.100660438940752     
  -0.461677682549452        0.129423776708626D-001   0.789294816634358D-001
  -0.461677682549452        0.129423776708626D-001   0.789294816634358D-001
  -0.916259796114754D-001  -0.594166571696935       -0.221789144407478     
   0.000000000000000        0.000000000000000        0.000000000000000     
   0.951503111087557       -0.319897600780051       -0.582977453515619D-001
   0.951503111087557       -0.319897600780051       -0.582977453515619D-001
  -0.916259796114754D-001  -0.594166571696935        0.253502667293864     
  -0.916259796114754D-001  -0.594166571696935        0.253502667293864     
  -0.646352214204715       -0.733218789039146       -0.107625369307040     
  -0.646352214204715       -0.733218789039146       -0.107625369307040     
   0.701919661025576       -0.785106017959438       -0.450494698883267     
   0.951503111087557       -0.319897600780051       -0.582977453515619D-001
   0.960029524741913       -0.235066731966406        0.712702404397861D-001
  -0.916259796114754D-001  -0.594166571696935        0.253502667293864     
  -0.898033771414972D-001  -0.460542888345873        0.271402749569239     
  -0.646352214204715       -0.733218789039146       -0.107625369307040     
  -0.643524646498280       -0.647472860313860       -0.844026275224740D-001
   0.701919661025576       -0.785106017959438       -0.192491362639991D-002
   0.698716126035789       -0.729890126097102       -0.269392886716115     
   0.000000000000000        0.000000000000000       -0.420353151152190     
   0.960029524741913       -0.235066731966406        0.712702404397861D-001
   0.960029524741913       -0.235066731966406        0.712702404397861D-001
  -0.898033771414972D-001  -0.460542888345873        0.271402749569239     
  -0.898033771414972D-001  -0.460542888345873        0.271402749569239     
  -0.643524646498280       -0.647472860313860       -0.844026275224740D-001
  -0.643524646498280       -0.647472860313860       -0.844026275224740D-001
   0.698716126035789       -0.729890126097102       -0.269392886716115     
   0.960029524741913       -0.235066731966406        0.324145824739995     
    1.00000000000000       -0.782743564921270D-002  -0.398084742784398     
   0.000000000000000        0.000000000000000        0.000000000000000     
    1.00000000000000       -0.782743564921270D-002  -0.398084742784398     
    27.6417116690011                0
   0.000000000000000        0.000000000000000        0.116927079847375     
  -0.527378266660011        0.381699864791307D-001   0.885765874734704D-001
  -0.527378266660011        0.381699864791307D-001   0.885765874734704D-001
  -0.710793051457440D-001  -0.702105449573676       -0.266426998143695     
   0.000000000000000        0.000000000000000        0.000000000000000     
   0.324383535232333D-001  -0.377047831572372        0.373512428938526D-001
   0.324383535232333D-001  -0.377047831572372        0.373512428938526D-001
  -0.710793051457440D-001  -0.702105449573676       -0.109893955136511D-001
  -0.710793051457440D-001  -0.702105449573676       -0.109893955136511D-001
   0.301385089507950       -0.882636114708735        0.410508784160200D-001
   0.301385089507950       -0.882636114708735        0.410508784160200D-001
  -0.995633314178618D-001  -0.951089371626408        0.136694026140274     
   0.324383535232333D-001  -0.377047831572372        0.373512428938526D-001
   0.343986966432464D-001   0.360334655174427        0.485685563460639D-001
  -0.710793051457440D-001  -0.702105449573676       -0.109893955136511D-001
  -0.643385807764635D-001   0.662773409303168       -0.110292115838203D-001
   0.301385089507950       -0.882636114708735        0.410508784160200D-001
   0.301209131027949        0.887754248267665        0.456135124952039D-001
  -0.995633314178618D-001  -0.951089371626408        0.448705415324926     
  -0.994457825521414D-001    1.00000000000000        0.123158481132066     
   0.000000000000000        0.000000000000000       -0.405300584429394D-001
   0.343986966432464D-001   0.360334655174427        0.485685563460639D-001
   0.343986966432464D-001   0.360334655174427        0.485685563460639D-001
  -0.643385807764635D-001   0.662773409303168       -0.110292115838203D-001
  -0.643385807764635D-001   0.662773409303168       -0.110292115838203D-001
   0.301209131027949        0.887754248267665        0.456135124952039D-001
   0.301209131027949        0.887754248267665        0.456135124952039D-001
  -0.994457825521414D-001    1.00000000000000        0.123158481132066     
   0.343986966432464D-001   0.360334655174427       -0.449589346996999D-001
  -0.327329892461504D-001   0.142322998450320D-001  -0.204922444102444D-001
   0.000000000000000        0.000000000000000        0.000000000000000     
  -0.327329892461504D-001   0.142322998450320D-001  -0.204922444102444D-001
    30.2839196618227                0
   0.000000000000000        0.000000000000000        0.121893301243873     
  -0.698346497144713        0.332538137676062        0.183265777337247     
  -0.698346497144713        0.332538137676062        0.183265777337247     
  -0.738591352470356        0.467358864749226       -0.642309712985371     
   0.000000000000000        0.000000000000000        0.000000000000000     
   0.730827803687039        0.251512959937943        0.116463584201155     
   0.730827803687039        0.251512959937943        0.116463584201155     
  -0.738591352470356        0.467358864749226       -0.129798663995924D-001
  -0.738591352470356        0.467358864749226       -0.129798663995924D-001
   0.998543901304878        0.608649524159753       -0.139262316660338     
   0.998543901304878        0.608649524159753       -0.139262316660338     
  -0.655233453085954        0.594389714062749        0.718344347008763     
   0.730827803687039        0.251512959937943        0.116463584201155     
   0.746286394195745        0.880180764361493D-001   0.216035400286613     
  -0.738591352470356        0.467358864749226       -0.129798663995924D-001
  -0.718635972178982        0.102254746100062       -0.946875205061240D-001
   0.998543901304878        0.608649524159753       -0.139262316660338     
    1.00000000000000        0.661230561578273D-001  -0.193263034476582     
  -0.655233453085954        0.594389714062749       -0.805112731494196     
  -0.654043268372416       -0.779869728591614D-002   0.705256905079281     
   0.000000000000000        0.000000000000000       -0.434204858195593     
   0.746286394195745        0.880180764361493D-001   0.216035400286613     
   0.746286394195745        0.880180764361493D-001   0.216035400286613     
  -0.718635972178982        0.102254746100062       -0.946875205061240D-001
  -0.718635972178982        0.102254746100062       -0.946875205061240D-001
    1.00000000000000        0.661230561578273D-001  -0.193263034476582     
    1.00000000000000        0.661230561578273D-001  -0.193263034476582     
  -0.654043268372416       -0.779869728591614D-002   0.705256905079281     
   0.746286394195745        0.880180764361493D-001   0.316770882561175     
   0.740992675574888        0.333795381250351D-001  -0.350416708497090     
   0.000000000000000        0.000000000000000        0.000000000000000     
   0.740992675574888        0.333795381250351D-001  -0.350416708497090     
    37.6488007064045                0
   0.000000000000000        0.000000000000000        0.269740685663196D-001
  -0.181408031151567        0.175181513244287        0.577905862314369D-001
  -0.181408031151567        0.175181513244287        0.577905862314369D-001
   0.138126945040730D-001  -0.121209384877781       -0.388284263786659     
   0.000000000000000        0.000000000000000        0.000000000000000     
   0.412477404633550D-001  -0.961261661415005D-001  -0.450674460900541D-001
   0.412477404633550D-001  -0.961261661415005D-001  -0.450674460900541D-001
   0.138126945040730D-001  -0.121209384877781       -0.455725490629529D-001
   0.138126945040730D-001  -0.121209384877781       -0.455725490629529D-001
   0.269431595917938       -0.614216352747035D-001  -0.104282253402297     
   0.269431595917938       -0.614216352747035D-001  -0.104282253402297     
  -0.230791856673514        0.959847724511992D-001   0.254156264523572     
   0.412477404633550D-001  -0.961261661415005D-001  -0.450674460900541D-001
   0.419524353409037D-001  -0.224369789474610        0.700640781548557D-001
   0.138126945040730D-001  -0.121209384877781       -0.455725490629529D-001
   0.267473154552195D-001  -0.328701599539578       -0.751184302664963D-001
   0.269431595917938       -0.614216352747035D-001  -0.104282253402297     
   0.257959522086952       -0.302764238553858        0.229998233597458     
  -0.230791856673514        0.959847724511992D-001    1.00000000000000     
  -0.228887672505266       -0.126723948375893       -0.383997971002064     
   0.000000000000000        0.000000000000000       -0.596231740268730D-001
   0.419524353409037D-001  -0.224369789474610        0.700640781548557D-001
   0.419524353409037D-001  -0.224369789474610        0.700640781548557D-001
   0.267473154552195D-001  -0.328701599539578       -0.751184302664963D-001
   0.267473154552195D-001  -0.328701599539578       -0.751184302664963D-001
   0.257959522086952       -0.302764238553858        0.229998233597458     
   0.257959522086952       -0.302764238553858        0.229998233597458     
  -0.228887672505266       -0.126723948375893       -0.383997971002064     
   0.419524353409037D-001  -0.224369789474610        0.106753361217640D-003
   0.822666582176169D-001  -0.170552028498005D-001   0.117329995208595D-002
   0.000000000000000        0.000000000000000        0.000000000000000     
   0.822666582176169D-001  -0.170552028498005D-001   0.117329995208595D-002
    41.5011127863044                0
   0.000000000000000        0.000000000000000        0.610082242196525D-001
  -0.674004024474496D-001  -0.454715621746531       -0.759648114538607D-001
  -0.674004024474496D-001  -0.454715621746531       -0.759648114538607D-001
  -0.372754342036412        0.160081827053263D-001    1.00000000000000     
   0.000000000000000        0.000000000000000        0.000000000000000     
   0.101863695080412       -0.797252307508528D-002   0.375130602906551D-001
   0.101863695080412       -0.797252307508528D-002   0.375130602906551D-001
  -0.372754342036412        0.160081827053263D-001  -0.253218144085728D-002
  -0.372754342036412        0.160081827053263D-001  -0.253218144085728D-002
   0.213142576377156        0.103491187627457       -0.989128363702420D-001
   0.213142576377156        0.103491187627457       -0.989128363702420D-001
  -0.147739881859741        0.157616889453176        0.203473608188743     
   0.101863695080412       -0.797252307508528D-002   0.375130602906551D-001
   0.107376052951927       -0.408778855173187D-001   0.136519717584570     
  -0.372754342036412        0.160081827053263D-001  -0.253218144085728D-002
  -0.383293065474230       -0.590588815480167D-001  -0.487313560193122D-001
   0.213142576377156        0.103491187627457       -0.989128363702420D-001
   0.210662744630632       -0.585248084763634D-001  -0.343187560851343D-001
  -0.147739881859741        0.157616889453176        0.116627485247600     
  -0.146976762464912       -0.286616055725309D-001   0.370394097284720D-001
   0.000000000000000        0.000000000000000       -0.132502696610741     
   0.107376052951927       -0.408778855173187D-001   0.136519717584570     
   0.107376052951927       -0.408778855173187D-001   0.136519717584570     
  -0.383293065474230       -0.590588815480167D-001  -0.487313560193122D-001
  -0.383293065474230       -0.590588815480167D-001  -0.487313560193122D-001
   0.210662744630632       -0.585248084763634D-001  -0.343187560851343D-001
   0.210662744630632       -0.585248084763634D-001  -0.343187560851343D-001
  -0.146976762464912       -0.286616055725309D-001   0.370394097284720D-001
   0.107376052951927       -0.408778855173187D-001   0.123756197732332     
   0.123650071074648        0.212915785801095D-001  -0.744121046413780D-001
   0.000000000000000        0.000000000000000        0.000000000000000     
   0.123650071074648        0.212915785801095D-001  -0.744121046413780D-001
    44.7751153323335                0
   0.000000000000000        0.000000000000000       -0.667996856781908D-001
   0.263335996662016       -0.427909755466194D-001  -0.330377141256562D-001
   0.263335996662016       -0.427909755466194D-001  -0.330377141256562D-001
  -0.446737328899813D-002   0.378273890022700        0.576985041021709D-001
   0.000000000000000        0.000000000000000        0.000000000000000     
  -0.693819757637100D-001   0.144126208910032       -0.425151219348660     
  -0.693819757637100D-001   0.144126208910032       -0.425151219348660     
  -0.446737328899813D-002   0.378273890022700         1.00000000000000     
  -0.446737328899813D-002   0.378273890022700         1.00000000000000     
  -0.136709170019608       -0.202241228425520       -0.839718713309588     
  -0.136709170019608       -0.202241228425520       -0.839718713309588     
   0.101676451046552       -0.305627971805957        0.424873948135156     
  -0.693819757637100D-001   0.144126208910032       -0.425151219348660     
  -0.106300287904945        0.220434764429532        0.482217447959261     
  -0.446737328899813D-002   0.378273890022700         1.00000000000000     
   0.202809551048420D-002   0.465631379542823       -0.980004467543729     
  -0.136709170019608       -0.202241228425520       -0.839718713309588     
  -0.110779929466605       -0.495014530266189D-001   0.771312281545138     
   0.101676451046552       -0.305627971805957       -0.148193046701316     
   0.773996407606013D-001  -0.141966154400372       -0.265131728121082     
   0.000000000000000        0.000000000000000       -0.246817855099900     
  -0.106300287904945        0.220434764429532        0.482217447959261     
  -0.106300287904945        0.220434764429532        0.482217447959261     
   0.202809551048420D-002   0.465631379542823       -0.980004467543729     
   0.202809551048420D-002   0.465631379542823       -0.980004467543729     
  -0.110779929466605       -0.495014530266189D-001   0.771312281545138     
  -0.110779929466605       -0.495014530266189D-001   0.771312281545138     
   0.773996407606013D-001  -0.141966154400372       -0.265131728121082     
  -0.106300287904945        0.220434764429532        0.395327386986535D-001
  -0.144991933106508        0.274197072994744D-001   0.617962330838181D-002
   0.000000000000000        0.000000000000000        0.000000000000000     
  -0.144991933106508        0.274197072994744D-001   0.617962330838181D-002
    46.1179757514570                0
   0.000000000000000        0.000000000000000       -0.244714519202247D-002
   0.267050763807595D-001  -0.566703919073599D-001  -0.116069087867116D-001
   0.267050763807595D-001  -0.566703919073599D-001  -0.116069087867116D-001
  -0.716044610745691D-001   0.100374637853773        0.117820489973946     
   0.000000000000000        0.000000000000000        0.000000000000000     
  -0.769207618359271D-001   0.346523333540734        0.571690560601117     
  -0.769207618359271D-001   0.346523333540734        0.571690560601117     
  -0.716044610745691D-001   0.100374637853773       -0.167218505570661     
  -0.716044610745691D-001   0.100374637853773       -0.167218505570661     
   0.523972654508851D-001  -0.145008973295678       -0.249878956116906     
   0.523972654508851D-001  -0.145008973295678       -0.249878956116906     
  -0.306444594387935D-001  -0.126040560662692        0.191492856069629     
  -0.769207618359271D-001   0.346523333540734        0.571690560601117     
  -0.651534586001148D-001   0.426264851599118       -0.644788897679887     
  -0.716044610745691D-001   0.100374637853773       -0.167218505570661     
  -0.381163868641986D-001   0.543275340188907D-001   0.139491443878076     
   0.523972654508851D-001  -0.145008973295678       -0.249878956116906     
   0.381504618339922D-001  -0.289984786058251        0.247091308867429     
  -0.306444594387935D-001  -0.126040560662692        0.312943935761752     
  -0.364250042828652D-001  -0.310207862256061       -0.212763283233610     
   0.000000000000000        0.000000000000000        0.437555139109565     
  -0.651534586001148D-001   0.426264851599118       -0.644788897679887     
  -0.651534586001148D-001   0.426264851599118       -0.644788897679887     
  -0.381163868641986D-001   0.543275340188907D-001   0.139491443878076     
  -0.381163868641986D-001   0.543275340188907D-001   0.139491443878076     
   0.381504618339922D-001  -0.289984786058251        0.247091308867429     
   0.381504618339922D-001  -0.289984786058251        0.247091308867429     
  -0.364250042828652D-001  -0.310207862256061       -0.212763283233610     
  -0.651534586001148D-001   0.426264851599118         1.00000000000000     
  -0.736524372251431D-001   0.269603030122083       -0.358446574949825     
   0.000000000000000        0.000000000000000        0.000000000000000     
  -0.736524372251431D-001   0.269603030122083       -0.358446574949825     
```

### 前10阶的振动频率

| 阶数 | 频率 |
| --- | --- |
| 1 | 3.84799970125667 |
| 2 | 10.568275704168 |
| 3 | 19.8878018790325 |
| 4 | 21.7642740576463 |
| 5 | 27.4001084033156 |
| 6 | 29.7721446176984 |
| 7 | 35.5588102896018 |
| 8 | 37.9653721223465 |
| 9 | 44.7521908277693 |
| 10 | 46.1155559115829 |


## 第二题
### 输入文件
```latex
           2
           8           1  5.000000000000000E-005
           3           4           3           0           0
  	   0  	       6           0           0           0
           6           6           1           2           3
          12           6           0           0           0
           6           0           0           0           0
           1           2   1000000000.00000        1.00000000000000     
   1.00000000000000     
           2           3   1000000000.00000        1.00000000000000     
   1.00000000000000     
           2           4   1000000000.00000        1.00000000000000     
   1.00000000000000     
```
### 输出结果
```latex
          10           0
           8
  0.428392183054052                0
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  1.215162881881980E-009  4.100306605222771E-018   1.00000000000000     
  1.215162881881980E-009  4.100306605222771E-018   1.00000000000000     
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  1.215162881881980E-009  4.100306605222771E-018   1.00000000000000     
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  0.621470828534652                3
           1           2  0.500000000000000     
  3.011525208326067E-010   1.00000000000000       1.980946544087562E-009
           2           2  0.500000000000000     
  3.011525208326067E-010  0.668806876009982      -1.886409541375069E-009
           3           2  0.500000000000000     
  0.331193123575984       3.034878215586987E-009 -1.446113506913789E-010
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  6.023050410835344E-010  6.069756425312642E-009 -1.555349699467490E-010
  6.023050410835344E-010  6.069756425312642E-009 -1.555349699467490E-010
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  6.023050410835344E-010  6.069756425312642E-009 -1.555349699467490E-010
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  0.621470828534652                3
           1           2  0.500000000000000     
  9.092958138169638E-010  0.202415906350268      -5.469104816024669E-010
           2           2  0.500000000000000     
  9.092958138169636E-010 -0.797584094899861       8.323548660858703E-010
           3           2  0.500000000000000     
   1.00000000000000      -1.082367885706583E-009 -4.366373096132686E-010
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  1.818591625877614E-009 -2.164735769322762E-009 -4.696203155140920E-010
  1.818591625877614E-009 -2.164735769322762E-009 -4.696203155140920E-010
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  1.818591625877614E-009 -2.164735769322762E-009 -4.696203155140920E-010
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
   1.38790116500536                0
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  4.173777977358335E-009  2.384537244609389E-017   1.00000000000000     
  4.173777977358335E-009  2.384537244609389E-017   1.00000000000000     
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  4.173777977358335E-009  2.384537244609389E-017   1.00000000000000     
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
   1.71313663580079                3
           1           2  0.500000000000000     
  3.465033060674868E-010 -9.329156963075181E-009   1.00000000000000     
           2           2  0.500000000000000     
  3.465033060705856E-010 -9.160679372044596E-009 -0.902032647102587     
           3           2  0.500000000000000     
 -1.537285716650407E-010  1.345469882508180E-008 -9.796735225437887E-002
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  6.930066014117243E-010  2.690939723375658E-008 -3.035943348563965E-010
  6.930066014117243E-010  2.690939723375658E-008 -3.035943348563965E-010
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  6.930066014117243E-010  2.690939723375658E-008 -3.035943348563965E-010
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
   1.71313663580079                3
           1           2  0.500000000000000     
 -3.536926313670202E-009  1.057167357609302E-010 -0.422615579517607     
           2           2  0.500000000000000     
 -3.536926313666443E-009 -1.609917468996290E-009 -0.577384427036893     
           3           2  0.500000000000000     
  1.572001876042205E-009  1.094812033879826E-009   1.00000000000000     
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
 -7.073852517858070E-009  2.189624033876517E-009  3.090060300782893E-009
 -7.073852517858070E-009  2.189624033876517E-009  3.090060300782893E-009
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
 -7.073852517858070E-009  2.189624033876517E-009  3.090060300782893E-009
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
   2.89577679303494                0
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  8.686405156491527E-009  1.107698763598325E-017   1.00000000000000     
  8.686405156491527E-009  1.107698763598325E-017   1.00000000000000     
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
  8.686405156491527E-009  1.107698763598325E-017   1.00000000000000     
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
   3.35842638187435                3
           1           2  0.500000000000000     
 -1.078586223619185E-010   1.00000000000000       6.744338636608687E-008
           2           2  0.500000000000000     
 -1.078586223619182E-010  0.991786486517266      -6.734967235136878E-008
           3           2  0.500000000000000     
  8.213513330208458E-003 -5.231168348884147E-008 -9.210425283970027E-011
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
 -2.157172335419306E-010 -1.046233615551160E-007  1.317701405093080E-010
 -2.157172335419306E-010 -1.046233615551160E-007  1.317701405093080E-010
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
 -2.157172335419306E-010 -1.046233615551160E-007  1.317701405093080E-010
  0.000000000000000E+000  0.000000000000000E+000  0.000000000000000E+000
```

### 前8阶频率
| 阶数 | 频率 |
| --- | --- |
| 1 | 0.428392183054052 |
| 2 | 0.621470828534652 |
| 3 | 0.621470828534652 |
| 4 | 1.38790116500536 |
| 5 | 1.71313663580079 |
| 6 | 1.71313663580079 |
| 7 | 2.89577679303494 |
| 8 | 3.35842638187435 |

